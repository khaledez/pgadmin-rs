<div class="flex flex-col h-full">
    {% if rows.is_empty() %}
    <div class="flex flex-col items-center justify-center h-full text-base-content/50">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 mb-2 opacity-30">
            <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
        </svg>
        <p class="text-sm">No data in this table</p>
    </div>
    {% else %}
    <!-- Data Grid -->
    <div class="flex-1 overflow-auto">
        <table class="table table-xs table-pin-rows table-pin-cols w-full">
            <thead>
                <tr>
                    <th class="bg-base-200 w-12 text-center">#</th>
                    {% for column in columns %}
                    <th class="bg-base-200 whitespace-nowrap">
                        <div class="flex items-center gap-1">
                            <span class="font-mono text-xs font-semibold">{{ column.name }}</span>
                            <span class="text-base-content/40 text-[10px] font-normal">{{ column.data_type }}</span>
                            {% if column.is_pk %}
                            <span class="badge badge-primary badge-xs ml-1">PK</span>
                            {% endif %}
                        </div>
                    </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in rows %}
                <tr class="hover">
                    <th class="bg-base-200 text-base-content/50 text-xs text-center">{{ loop.index }}</th>
                    {% for cell in row %}
                    <td class="font-mono text-xs whitespace-nowrap max-w-xs truncate">
                        {% match cell %}
                            {% when serde_json::Value::Null %}
                                <span class="text-base-content/30 italic">NULL</span>
                            {% when serde_json::Value::String with (s) %}
                                {% if s.is_empty() %}
                                    <span class="text-base-content/30">(empty)</span>
                                {% else %}
                                    <span title="{{ s }}" class="truncate max-w-xs block">{{ s }}</span>
                                {% endif %}
                            {% when serde_json::Value::Number with (n) %}
                                <span class="text-right block text-accent">{{ n }}</span>
                            {% when serde_json::Value::Bool with (b) %}
                                {% if b %}
                                    <span class="text-success">true</span>
                                {% else %}
                                    <span class="text-error">false</span>
                                {% endif %}
                            {% when serde_json::Value::Object with (_) %}
                                <span class="badge badge-ghost badge-xs cursor-pointer" title="Click to view JSON">{...}</span>
                            {% when serde_json::Value::Array with (_) %}
                                <span class="badge badge-ghost badge-xs cursor-pointer" title="Click to view array">[...]</span>
                            {% else %}
                                <code class="text-xs">{{ cell }}</code>
                        {% endmatch %}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination Footer -->
    {% if pagination.total_pages > 1 %}
    <div class="flex items-center justify-between px-4 py-2 bg-base-200 border-t border-base-300">
        <span class="text-xs text-base-content/50">
            Page {{ pagination.page }} of {{ pagination.total_pages }} ({{ pagination.total_rows }} rows)
        </span>
        <div class="join">
            <button class="join-item btn btn-xs"
                    {% if pagination.page == 1 %}disabled{% endif %}
                    hx-get="/api/schemas/{{ schema }}/tables/{{ table }}/data?page=1&page_size={{ pagination.page_size }}"
                    hx-target="#data-grid"
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5" />
                </svg>
            </button>
            <button class="join-item btn btn-xs"
                    {% if pagination.page == 1 %}disabled{% endif %}
                    hx-get="/api/schemas/{{ schema }}/tables/{{ table }}/data?page={{ pagination.page - 1 }}&page_size={{ pagination.page_size }}"
                    hx-target="#data-grid"
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                </svg>
            </button>
            <button class="join-item btn btn-xs btn-active">{{ pagination.page }}</button>
            <button class="join-item btn btn-xs"
                    {% if pagination.page >= pagination.total_pages %}disabled{% endif %}
                    hx-get="/api/schemas/{{ schema }}/tables/{{ table }}/data?page={{ pagination.page + 1 }}&page_size={{ pagination.page_size }}"
                    hx-target="#data-grid"
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                </svg>
            </button>
            <button class="join-item btn btn-xs"
                    {% if pagination.page >= pagination.total_pages %}disabled{% endif %}
                    hx-get="/api/schemas/{{ schema }}/tables/{{ table }}/data?page={{ pagination.total_pages }}&page_size={{ pagination.page_size }}"
                    hx-target="#data-grid"
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 4.5l7.5 7.5-7.5 7.5m6-15l7.5 7.5-7.5 7.5" />
                </svg>
            </button>
        </div>
    </div>
    {% endif %}
    {% endif %}
</div>
