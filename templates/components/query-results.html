{% match error %}
    {% when Some with (err) %}
        <div role="alert" class="alert alert-error">
            <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <div>
                <h3 class="font-bold">Query Error</h3>
                <div class="text-xs font-mono whitespace-pre-wrap break-words mt-1">{{ err }}</div>
            </div>
        </div>
    {% when None %}
        <!-- Results Info -->
        <div class="flex items-center justify-between mb-3 text-sm">
            <div class="flex items-center gap-2">
                <span class="badge badge-success badge-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3 mr-1">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                    </svg>
                    Success
                </span>
                <span class="text-base-content/70">
                    <strong>{{ row_count }}</strong>
                    {% if row_count == 1 %}row{% else %}rows{% endif %}
                </span>
                {% match execution_time_ms %}
                    {% when Some with (time) %}
                        <span class="text-base-content/50">{{ time }}ms</span>
                    {% when None %}
                {% endmatch %}
            </div>
        </div>

        {% if row_count > 0 %}
        <div class="overflow-x-auto">
            <table class="table table-xs table-zebra table-pin-rows">
                <thead>
                    <tr>
                        <th class="bg-base-200 w-12 text-center">#</th>
                        {% for column in columns %}
                        <th class="bg-base-200">
                            <span class="font-mono text-xs font-semibold">{{ column }}</span>
                        </th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in rows %}
                    <tr class="hover">
                        <th class="bg-base-200 text-base-content/50 text-xs text-center">{{ loop.index }}</th>
                        {% for cell in row %}
                        <td class="font-mono text-xs">
                            {% match cell %}
                                {% when serde_json::Value::Null %}
                                    <span class="text-base-content/30 italic">NULL</span>
                                {% when serde_json::Value::String with (s) %}
                                    {% if s.is_empty() %}
                                        <span class="text-base-content/30">(empty)</span>
                                    {% else %}
                                        {{ s }}
                                    {% endif %}
                                {% when serde_json::Value::Number with (n) %}
                                    <span class="text-accent text-right block">{{ n }}</span>
                                {% when serde_json::Value::Bool with (b) %}
                                    {% if b %}
                                        <span class="text-success">true</span>
                                    {% else %}
                                        <span class="text-error">false</span>
                                    {% endif %}
                                {% when serde_json::Value::Object with (_) %}
                                    <span class="badge badge-ghost badge-xs">{...}</span>
                                {% when serde_json::Value::Array with (_) %}
                                    <span class="badge badge-ghost badge-xs">[...]</span>
                                {% else %}
                                    <code class="text-xs">{{ cell }}</code>
                            {% endmatch %}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="flex flex-col items-center justify-center py-8 text-base-content/50">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 mb-2 opacity-30">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="text-sm">Query executed successfully with no results</p>
        </div>
        {% endif %}
{% endmatch %}
